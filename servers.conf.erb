limit_req_zone $binary_remote_addr zone=one:10m rate=10r/s;

server {
    server_name localhost;
    listen <%= ENV['PORT'] %>;
    charset utf-8;
    modsecurity on;
    location / {
        proxy_pass <%= ENV['PRODUCTION_SITE'] %>;
        modsecurity_rules_file secrules.conf;
        limit_req zone=one burst=20;
        #proxy_set_header      Host             $host;
        #proxy_set_header      Host             $http_host;
        #proxy_set_header     X-Forwarded-For  facili-tacct-nginx.osc-fr1.scalingo.io;
        #proxy_set_header     X-Forwarded-Host facili-tacct-nginx.osc-fr1.scalingo.io;
        #proxy_set_header      Referer          "https://facili-tacct.osc-fr1.scalingo.io";
    }
}
